---
title: "Eli Lab - Chromebook Forensics Analysis"
date: 2025-07-04 12:00:00 +0700
categories: [CTF, Forensics]
tags: [chromebook, chrome-os, google-takeout, ecryptfs, browser-forensics, sqlite]
image:
  path: /assets/img/posts/Eli-lab/banner.png
  alt: Eli Lab
---

## Giá»›i thiá»‡u

**Difficulty**: Medium  
**Category**: Endpoint

BÃ i lab phÃ¢n tÃ­ch Chromebook vÃ  dá»¯ liá»‡u Google Takeout Ä‘á»ƒ Ä‘iá»u tra hoáº¡t Ä‘á»™ng ngÆ°á»i dÃ¹ng.

## ğŸ’» Chromebook lÃ  gÃ¬?

**Chromebook** lÃ  má»™t loáº¡i **laptop** cháº¡y há»‡ Ä‘iá»u hÃ nh **Chrome OS** cá»§a Google.

### ğŸ”‘ Äáº·c Ä‘iá»ƒm chÃ­nh:

- Dá»±a trÃªn **trÃ¬nh duyá»‡t Chrome** â€“ háº§u háº¿t má»i hoáº¡t Ä‘á»™ng Ä‘á»u thá»±c hiá»‡n qua web.
- **Dá»¯ liá»‡u khÃ´ng lÆ°u nhiá»u trong mÃ¡y**, mÃ  Ä‘á»“ng bá»™ vá»›i tÃ i khoáº£n Google (Google Drive, Gmail, Chrome Syncâ€¦).
- Ráº¥t nháº¹, khá»Ÿi Ä‘á»™ng nhanh, phá»• biáº¿n trong trÆ°á»ng há»c vÃ  vÄƒn phÃ²ng.

### ğŸ“‚ Dá»¯ liá»‡u thÆ°á»ng lÆ°u trÃªn Chromebook:

- **Bá»™ nhá»› táº¡m thá»i (cache, local storage)**
- **Táº£i xuá»‘ng**: lÆ°u trong thÆ° má»¥c `Downloads/`
- **á»¨ng dá»¥ng vÃ  tiá»‡n Ã­ch má»Ÿ rá»™ng (extensions)**
- **Lá»‹ch sá»­ trÃ¬nh duyá»‡t Chrome** (file SQLite `History`)
- **TÃ i khoáº£n Google Ä‘Ã£ Ä‘Äƒng nháº­p**

## ğŸ“¦ Google Takeout lÃ  gÃ¬?

**Google Takeout** lÃ  má»™t dá»‹ch vá»¥ cá»§a Google cho phÃ©p **ngÆ°á»i dÃ¹ng táº£i toÃ n bá»™ dá»¯ liá»‡u cÃ¡ nhÃ¢n** tá»« tÃ i khoáº£n Google vá» mÃ¡y tÃ­nh.

> ğŸ§  Khi phÃ¢n tÃ­ch Chromebook, Google Takeout lÃ  nguá»“n dá»¯ liá»‡u cá»±c ká»³ quan trá»ng, vÃ¬ nÃ³ chá»©a táº¥t cáº£ hoáº¡t Ä‘á»™ng sá»‘ cá»§a ngÆ°á»i dÃ¹ng.

## Q1: The folder to store all your data in - How many files are in Eli's downloads directory?

### **ChromeOS sá»­ dá»¥ng eCryptfs Ä‘á»ƒ mÃ£ hÃ³a dá»¯ liá»‡u ngÆ°á»i dÃ¹ng**

> "ChromeOS... uses eCryptfs, a stacked cryptographic filesystem..."

- **eCryptfs** lÃ  há»‡ thá»‘ng mÃ£ hÃ³a file-layer: dá»¯ liá»‡u cá»§a ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c mÃ£ hÃ³a "táº§ng trÃªn" cá»§a há»‡ thá»‘ng file tháº­t.
- Äiá»u nÃ y cÃ³ nghÄ©a lÃ :
    - Khi mÃ¡y táº¯t, dá»¯ liá»‡u (bao gá»“m cáº£ Downloads) lÃ  **dáº¡ng mÃ£ hÃ³a**.
    - Khi ngÆ°á»i dÃ¹ng Ä‘Äƒng nháº­p, há»‡ thá»‘ng sáº½ **giáº£i mÃ£ tá»± Ä‘á»™ng (on the fly)** Ä‘á»ƒ sá»­ dá»¥ng.

### **Khi Ä‘Äƒng nháº­p, thÆ° má»¥c ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c giáº£i mÃ£**

> "When a user logs into their Chromebook... decrypted on the fly..."

- Trong forensic, báº¡n cÃ³ thá»ƒ truy cáº­p thÆ° má»¥c nÃ y **náº¿u Ä‘Ã£ trÃ­ch Ä‘Æ°á»£c báº£n decrypted hoáº·c cÃ³ quyá»n má»Ÿ khÃ³a**.
- ThÆ° má»¥c Downloads náº±m trong vÃ¹ng Ä‘Ã£ Ä‘Æ°á»£c giáº£i mÃ£ cá»§a ngÆ°á»i dÃ¹ng.

```bash
2021 CTF - Chromebook/decrypted/mount/user/Downloads
```

vÃ o thÆ° má»¥c trÃªn

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Chromebook/decrypted/mount/user/Downloads]
â””â”€$ ls
 network_diagnostics_2021-03-08.19-04-05.txt   third_party_1613945285717.jpg
'Screenshot 2021-03-04 at 3.16.31 AM.png'      tux.png
'Screenshot 2021-03-04 at 3.17.06 AM.png'      Wickr-Customer-Security-Promises-November-2020.pdf
```

6 file

## Q4: Promise Me - How many promises does Wickr make?

Wickr lÃ  1 app giao tiáº¿p end-to-end mÃ£ hÃ³a

![image.png](/assets/img/posts/Eli-lab/image.png)

9 promises

## Q8: Dress for success - What is this bird's image's logical size in bytes?

![image.png](/assets/img/posts/Eli-lab/image%201.png)

hoáº·c dÃ¹ng `ls -l`, `stat`

## Q2: Smile for the camera - What is the MD5 hash of the user's profile photo?

Dá»±a vÃ o resources https://www.magnetforensics.com/blog/chromebook-data-locations/

![image.png](/assets/img/posts/Eli-lab/image%202.png)

ta tÃ¬m kiáº¿m avatar image

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Chromebook]
â””â”€$ find ./ -name "Avatar*"
./decrypted/mount/user/Accounts/Avatar Images
```

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Chromebook]
â””â”€$ md5sum "./decrypted/mount/user/Accounts/Avatar Images/eflatt610@gmail.com"
5ddd4fe0041839deb0a4b0252002127b  ./decrypted/mount/user/Accounts/Avatar Images/eflatt610@gmail.com
```

## Q3: Road Trip! - What city was Eli's destination in?

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir]
â””â”€$ find ./ -iname "*map*"
./2021 CTF - Chromebook/decrypted/mount/user/Extensions/dmghijelimhndkbmpgbldicpogfkceaj/0.4.1_0/data/content_script/custom/maps.css
./2021 CTF - Chromebook/decrypted/mount/user/Extensions/hmjkmjkepdijhoojdojkdfohbdgmmhki/4.21072.600.1_0/ink/nothreads/ink.wasm.map
./2021 CTF - Chromebook/decrypted/mount/user/Extensions/hmjkmjkepdijhoojdojkdfohbdgmmhki/4.21072.600.1_0/ink/threads/ink.wasm.map
./2021 CTF - Takeout/Takeout/Maps
./2021 CTF - Takeout/Takeout/My Activity/Maps
```

![image.png](/assets/img/posts/Eli-lab/image%203.png)

nhÆ° váº­y Eli di chuyá»ƒn tá»« burlington Ä‘áº¿n `chick fil a`

## Q5: Key-ty Cat - What are the last five characters of the key for the Tabby Cat extension?

![image.png](/assets/img/posts/Eli-lab/image%204.png)

ta cáº§n tÃ¬m kiáº¿m cÃ¡c file manifest.json cá»§a extensions

File `manifest.json` lÃ  **trÃ¡i tim cá»§a má»™t extension (tiá»‡n Ã­ch má»Ÿ rá»™ng)** trÃªn trÃ¬nh duyá»‡t nhÆ° **Google Chrome**, **Chromium**, **Edge**, hoáº·c cáº£ **Firefox** (dÃ¹ cáº¥u trÃºc hÆ¡i khÃ¡c). NÃ³ Ä‘á»‹nh nghÄ©a **metadata vÃ  cáº¥u hÃ¬nh** cá»§a extension, nhÆ° lÃ :

### ğŸ§  **Chá»©c nÄƒng chÃ­nh cá»§a `manifest.json`:**

| ThÃ nh pháº§n | MÃ´ táº£ |
| --- | --- |
| `name` | TÃªn extension hiá»ƒn thá»‹ |
| `version` | PhiÃªn báº£n extension |
| `description` | MÃ´ táº£ ngáº¯n gá»n vá» extension |
| `manifest_version` | PhiÃªn báº£n schema (Chrome hiá»‡n yÃªu cáº§u v3) |
| `permissions` | Quyá»n mÃ  extension cáº§n (nhÆ° Ä‘á»c tab, truy cáº­p trang web...) |
| `background` | Script cháº¡y ná»n Ä‘á»ƒ xá»­ lÃ½ logic liÃªn tá»¥c |
| `content_scripts` | Script nhÃºng vÃ o trang web (VD: thay Ä‘á»•i ná»™i dung web) |
| `action` hoáº·c `browser_action` | Giao diá»‡n nÃºt cá»§a extension |
| `icons` | Icon cá»§a extension |
| `key` | Public key dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh ID extension (chá»‰ xuáº¥t hiá»‡n trong báº£n Ä‘Ã£ build/package) |

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Chromebook/decrypted/mount/user/Extensions]
â””â”€$ find ./ -name manifest.json -exec grep -li "tabby cat" {} \;
./mefhakmgclhhfbdadeojlkbllmecialg/2.0.0_0/manifest.json
```

file nÃ y lÃ  manifest.json cá»§a tabby cat

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Chromebook/decrypted/mount/user/Extensions]
â””â”€$ cat ./mefhakmgclhhfbdadeojlkbllmecialg/2.0.0_0/manifest.json | grep "key"
   "key": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjA9ElNuqHGIuDyrztUxn0nV1CLRgjSHEKw1zfhzE/6OdWd3teRV9wq4EukIX8UKf96fhS2WsLVnTuRmF7mQuqeAIxOkSvFm4Set3YRQ5994NA8Y9un1ZGhPtjFnpoLo1pEA5PPly5/BX2y3Ci2Rb0C3wp8NdeXud4r6BKEzhPdWmkwIS+YbTWhOBR1IbP/sF6+l8EdG/Ks881p8LO0J3qepmhNDA/LjVWzJq5ARmIYeT3TnvR/qRGTY9UXfUvg3gcUWV2LBBpeil8t6Np0PVYvG44zOBhKUnYSVE6gAcXENLTJJABgRgKT1K1kDYl1N8LJZf/S/9Ix1P+wItoEinTwIDAQAB"
```

## Q6: Time to jam out - How many songs does Eli have downloaded?

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Chromebook]
â””â”€$ find ./ -iname "*music*"
./decrypted/mount/user/MyFiles/Music
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Chromebook]
â””â”€$ find ./ -iname "*music*" -exec ls {} \;
'alt-J (âˆ†) Breezeblocks.mp3'  'Leave - Post Malone.mp3'
```

## Q7: Autofill, roll out - Which word was Autofilled the most?

Ta tÃ¬m nhá»¯ng file cÃ³ "Autofill" vÃ  lÃ  sqlite

```bash
find ./ -type f -exec file {} \; | grep -i "sqlite"
```

sá»­ dá»¥ng lá»‡nh nÃ y

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Chromebook]
â””â”€$ find . -type f -exec sh -c 'file "$1" | grep -iq sqlite && grep -iq autofill "$1" && echo "$1"' _ {} \;
./decrypted/encrypted/chronos/Default/Web Data
./decrypted/encrypted/chronos/LockScreenAppsProfile/Web Data
```

`-c` lÃ  **tÃ¹y chá»n cá»§a lá»‡nh `sh` (shell)**, dÃ¹ng Ä‘á»ƒ **cháº¡y má»™t Ä‘oáº¡n lá»‡nh (command string)** Ä‘Æ°á»£c truyá»n trá»±c tiáº¿p dÆ°á»›i dáº¡ng chuá»—i.

| `file "$1"` | Kiá»ƒm tra loáº¡i file (vÃ­ dá»¥: "SQLite 3.x database") |
| --- | --- |
| `grep -iq sqlite` | TÃ¬m tá»« "sqlite" trong káº¿t quáº£ `file`, **khÃ´ng phÃ¢n biá»‡t hoa thÆ°á»ng**, `-q` Ä‘á»ƒ **khÃ´ng in ra gÃ¬**, chá»‰ kiá»ƒm tra Ä‘Ãºng/sai |
| `grep -iq autofill "$1"` | Kiá»ƒm tra ná»™i dung cá»§a file cÃ³ chá»©a `"autofill"` khÃ´ng |
| `&& echo "$1"` | Náº¿u cáº£ 2 Ä‘iá»u kiá»‡n trÃªn Ä‘Ãºng, thÃ¬ in ra tÃªn file |

| Biáº¿n | Ã nghÄ©a |
| --- | --- |
| `$0` | TÃªn cá»§a chÆ°Æ¡ng trÃ¬nh Ä‘ang cháº¡y (hoáº·c tÃªn giáº£ Ä‘á»‹nh náº¿u dÃ¹ng `sh -c`) |
| `$1`, `$2`, ... | Tham sá»‘ thá»© 1, 2, ... Ä‘Æ°á»£c truyá»n vÃ o sau tÃªn |

$0 lÃ  tÃªn chÆ°Æ¡ng trÃ¬nh khÃ´ng nÃªn dÃ¹ng

- `sh -c '...' _ {}`:
    - `'...'` lÃ  Ä‘oáº¡n shell
    - `_` lÃ  giÃ¡ trá»‹ cho `$0` (báº¯t buá»™c nhÆ°ng khÃ´ng quan trá»ng)
    - `{}` (file name) â†’ Ä‘Æ°á»£c gÃ¡n vÃ o `$1`

váº½ tháº¿ thÃ´i nhÆ°ng khÃ´ng tÃ¬m Ä‘Æ°á»£c

![image.png](/assets/img/posts/Eli-lab/image%205.png)

## Q9: Repeat customer - What was Eli's top visited site?

![image.png](/assets/img/posts/Eli-lab/image%206.png)

## Q10: Vroom Vroom, What is the name of the car-related theme?

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Takeout/Takeout]
â””â”€$ grep -lir "theme" *
Chrome/BrowserHistory.json
Chrome/Extensions.json
Chrome/SyncSettings.json
Drive/To-Purchase.xlsx
Drive/Untitled document.docx
```

kiá»ƒm tra cÃ¡c file nÃ y

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Takeout/Takeout]
â””â”€$ grep -i "theme" Chrome/SyncSettings.json
    "Themes": [
            "custom_theme_id": "dkkklbgbfaeockpgbkleblklmcjdbnbj",
            "custom_theme_update_url": "http://clients2.google.com/service/update2/crx",
            "custom_theme_name": "Lamborghini Cherry",
            "use_system_theme_by_default": false,
            "use_custom_theme": true
```

## Q11: You got mail - How many emails were received from notification@service.tiktok.com?

![image.png](/assets/img/posts/Eli-lab/image%207.png)

## Q12: Hungry for directions - Where did the user request directions to on Mar 4, 2021, at 4:15:18 AM EDT

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Takeout/Takeout]
â””â”€$ grep -lir "march" *
Chrome/BrowserHistory.json
Mail/All mail Including Spam and Trash.mbox
My Activity/Ads/MyActivity.html
My Activity/Chrome/MyActivity.html
My Activity/Search/MyActivity.html
```

cÃ³ váº» lÃ  file browserhistory.json hoáº·c 2 file cuá»‘i

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Takeout/Takeout]
â””â”€$ grep -lir "4:15:18" *
My Activity/Maps/MyActivity.html
```

nháº§m

![image.png](/assets/img/posts/Eli-lab/image%208.png)

## Q13: Who defines essential? - What was searched on Mar 4, 2021, at 4:09:35 AM EDT

tÃ¬m tÆ°Æ¡ng tá»±

## Q14: I got three subscribers, and counting - How many YouTube channels is the user subscribed to?

![image.png](/assets/img/posts/Eli-lab/image%209.png)

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Takeout/Takeout]
â””â”€$ find ./ -iname "*subscri*"
./Google Account/e.flatt610.SubscriberInfo.html
./YouTube and YouTube Music/subscriptions
./YouTube and YouTube Music/subscriptions/subscriptions.json
```

```bash
â”Œâ”€â”€(nqghuyã‰¿DESKTOP-AJTP5JK)-[~/forensics/98-Chromebook/temp_extract_dir/2021 CTF - Takeout/Takeout]
â””â”€$ cat "./YouTube and YouTube Music/subscriptions/subscriptions.json"
[ ]
```

## Q15: Time flies when you're watching YT - What date was the first YouTube video the user watched uploaded?

![image.png](/assets/img/posts/Eli-lab/image%2010.png)

![image.png](/assets/img/posts/Eli-lab/image%2011.png)

tÃ¬m kiáº¿m tool thÃ¬ lÃ  27/1/2021

## Tham kháº£o
- [Chromebook Data Locations](https://www.magnetforensics.com/blog/chromebook-data-locations/)
- [Chrome OS Forensics](https://www.sans.org/reading-room/whitepapers/forensics/chrome-os-forensics-38050)
- [Google Takeout](https://takeout.google.com/)