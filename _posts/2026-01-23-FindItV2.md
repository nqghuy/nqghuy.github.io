---
title: "Find It V2"
date: 2026-01-25 12:00:00 +0700
categories: [CTF, Forensics]
tags: [docker]
image:
  path: /assets/img/posts/Find_It_V2/banner.png
---

1 thử thách CTF forensics đến từ VSL. Thử thách lần này liên quan đến 1 docker
![alt text](/assets/img/posts/Find_It_V2/image.png)
![alt text](image.png)
Tiến hành chạy theo thử thách
```
nguyen@nqghuy:~/Documents$ sudo docker run --rm -it -p 80:80 ph4n10m1808/findit
AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.17.0.2. Set the 'ServerName' directive globally to suppress this message

```

![alt text](/assets/img/posts/Find_It_V2/image-1.png)

Với những thử thách như này, ta nghĩ ngay đến phân tích các layer có trong image.

```
nguyen@nqghuy:~/Documentssudo docker history --no-trunc ph4n10m1808/finditit
IMAGE                                                                     CREATED       CREATED BY                                                                                                                                                                                  SIZE      COMMENT
sha256:6e24377f77e700471814dd453024e24b837a1a08f6bbfc3f4f261a6057e5c62b   7 days ago    CMD ["apachectl" "-D" "FOREGROUND"]                                                                                                                                                         0B        buildkit.dockerfile.v0
<missing>                                                                 7 days ago    RUN /bin/sh -c sed -i 's/Options Indexes FollowSymLinks/Options FollowSymLinks/' /etc/apache2/apache2.conf &&     chown -R www-data:www-data /var/www/html/ &&     rm -rf .git # buildkit   36.9kB    buildkit.dockerfile.v0
<missing>                                                                 7 days ago    COPY src/ . # buildkit                                                                                                                                                                      20.5kB    buildkit.dockerfile.v0
<missing>                                                                 7 days ago    COPY /var/www/html/.git .git # buildkit                                                                                                                                                     233kB     buildkit.dockerfile.v0
<missing>                                                                 7 days ago    WORKDIR /var/www/html                                                                                                                                                                       4.1kB     buildkit.dockerfile.v0
<missing>                                                                 7 days ago    RUN /bin/sh -c apt update &&     apt full-upgrade -y &&     apt install -y apache2 git &&     apt clean &&     rm -rf /var/lib/apt/lists/* # buildkit                                       142MB     buildkit.dockerfile.v0
<missing>                                                                 2 weeks ago   /bin/sh -c #(nop)  CMD ["/bin/bash"]                                                                                                                                                        0B        
<missing>                                                                 2 weeks ago   /bin/sh -c #(nop) ADD file:b499000226bd9a7c562ffa8eeb86e2d170f2a563310db6c2d79562ab53e5cb6e in /                                                                                            87.5MB    
<missing>                                                                 2 weeks ago   /bin/sh -c #(nop)  LABEL org.opencontainers.image.version=22.04                                                                                                                             0B        
<missing>                                                                 2 weeks ago   /bin/sh -c #(nop)  LABEL org.opencontainers.image.ref.name=ubuntu                                                                                                                           0B        
<missing>                                                                 2 weeks ago   /bin/sh -c #(nop)  ARG LAUNCHPAD_BUILD_ARCH                                                                                                                                                 0B        
<missing>                                                                 2 weeks ago   /bin/sh -c #(nop)  ARG RELEASE                                                                                                                                                              0B   
```

Ta thấy dev đã vô tình `COPY /var/www/html/.git .git # buildkit ` và sau đó xóa đi bằng `rm -rf .git`

Tiếp theo ta tiến hành lưu ra file tar và phân tích thủ công
```
sudo docker save ph4n10m1808/findit -o findit.tar
mkdir extracted_layers
tar -xf findit.tar -C extracted_layers
```

```
nguyen@nqghuy:~/CTF/forenshits/extracted_layers$ tree
.
├── blobs
│   └── sha256
│       ├── 05516cf83f133c2bf6dec06113b7e27cc659215a0fa1573a966b52cb99bbe26b
│       ├── 200c3cfd948534150410e8c182d95ef167a77a4fa82c17e01262aa64f238095f
│       ├── 4eaa4b9ac68ee8a4bc8bac7e9bb7113d89ff00fbb52c90c04a8681f77ccc1a94
│       ├── 4f4fb700ef54461cfa02571ae0db9a0dc1e0cdb5577484a6d75e68dc38e8acc1
│       ├── 6278e641ff7947a7f6f1439a2defab4af4e4e1eb1fbf2be090b5b99fdba96c9b
│       ├── 6e24377f77e700471814dd453024e24b837a1a08f6bbfc3f4f261a6057e5c62b
│       ├── 6f4ebca3e823b18dac366f72e537b1772bc3522a5c7ae299d6491fb17378410e
│       └── 75a1166ddf84031394c0bcec535b97b535c44391675846259be72de19c0d5246
├── index.json
├── manifest.json
├── oci-layout

nguyen@nqghuy:~/CTF/forenshits/extracted_layers$ file blobs/sha256/*
blobs/sha256/05516cf83f133c2bf6dec06113b7e27cc659215a0fa1573a966b52cb99bbe26b: gzip compressed data, original size modulo 2^32 133475328
blobs/sha256/200c3cfd948534150410e8c182d95ef167a77a4fa82c17e01262aa64f238095f: JSON text data
blobs/sha256/4eaa4b9ac68ee8a4bc8bac7e9bb7113d89ff00fbb52c90c04a8681f77ccc1a94: gzip compressed data, original size modulo 2^32 13312
blobs/sha256/4f4fb700ef54461cfa02571ae0db9a0dc1e0cdb5577484a6d75e68dc38e8acc1: gzip compressed data, original size modulo 2^32 1024
blobs/sha256/6278e641ff7947a7f6f1439a2defab4af4e4e1eb1fbf2be090b5b99fdba96c9b: gzip compressed data, original size modulo 2^32 64000
blobs/sha256/6e24377f77e700471814dd453024e24b837a1a08f6bbfc3f4f261a6057e5c62b: JSON text data
blobs/sha256/6f4ebca3e823b18dac366f72e537b1772bc3522a5c7ae299d6491fb17378410e: gzip compressed data, was "fbb9bbbaf4d2b027acd15252897d5043386eea7121e0e0433e697714bb14beac.tar", last modified: Fri Jan  9 07:01:45 2026, max compression, original size modulo 2^32 80419840
blobs/sha256/75a1166ddf84031394c0bcec535b97b535c44391675846259be72de19c0d5246: gzip compressed data, original size modulo 2^32 3584
```

Ta có các file sha256 kia chính là các layer của docker 
Tiếp theo ta tiến hành extract các layer trên
```
nguyen@nqghuy:~/CTF/forenshits/extracted_layers$ for f in blobs/sha256/*; do tar -xf "$f" -C RECOVERY; done
tar: This does not look like a tar archive
tar: Skipping to next header
tar: Exiting with failure status due to previous errors
tar: This does not look like a tar archive
tar: Skipping to next header
tar: Exiting with failure status due to previous errors
```

kiểm tra nội dung bên trong
```
nguyen@nqghuy:~/CTF/forenshits/extracted_layers$ ls -la RECOVERY/var/www/html
total 16
drwxr-xr-x 3 nguyen nguyen 4096 Jun  6  2025 .
drwxr-xr-x 3 nguyen nguyen 4096 Jan 17 08:51 ..
drwxr-xr-x 8 nguyen nguyen 4096 Jan 17 09:07 .git
-rwxrwxr-x 1 nguyen nguyen  481 Jun  6  2025 index.html
-rw------- 1 nguyen nguyen    0 Jan 17 09:07 .wh..git
```
Ta đã thấy thư mục .git. Ta kiểm tra log
```
nguyen@nqghuy:~/CTF/forenshits/extracted_layers/RECOVERY/var/www/html/.git$ git log
commit 57cb3c04ad9c3fcab349948f82f3e75dad7abc08 (HEAD -> main)
Author: VSL <vsl@vku.udn.vn>
Date:   Sat Jan 17 02:07:05 2026 +0000

    Added website files

commit c41ef63f94eedac90431bc772b5a63a2569a9572
Author: VSL <vsl@vku.udn.vn>
Date:   Sat Jan 17 02:07:05 2026 +0000

    Cleaned up project

commit 6c806228bc41124a2cbc3f4728d4f4edeebcad6b
Author: VSL <vsl@vku.udn.vn>
Date:   Sat Jan 17 02:07:05 2026 +0000

    Added secret configuration
```

Ta thấy được secret config. 
```
nguyen@nqghuy:~/CTF/forenshits/extracted_layers/RECOVERY/var/www/html/.git$ git show 6c806228bc41124a2cbc3f4728d4f4edeebcad6b
commit 6c806228bc41124a2cbc3f4728d4f4edeebcad6b
Author: VSL <vsl@vku.udn.vn>
Date:   Sat Jan 17 02:07:05 2026 +0000

    Added secret configuration

diff --git a/.secret_flag.txt b/.secret_flag.txt
new file mode 100755
index 0000000..9a298e6
--- /dev/null
+++ b/.secret_flag.txt
@@ -0,0 +1 @@
+VSL{H1d3n_1n_l4y3r_d0k3r}
\ No newline at end of file
```

|Flag: VSL{H1d3n_1n_l4y3r_d0k3r}
